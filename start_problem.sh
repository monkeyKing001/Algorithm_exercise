#!/bin/bash

printf "\033[1;37m"
echo "#(((((((((###########################################################################.,((((((*.*#((((#/.,((((((/../((/..,,.  *((, ,****. ,(.,((((((((((*.,,/((*./(((###(..*(((((((((((*  ,/////////((((("
echo "###################################################################################(../(((((/ ,(../((///(((((((/,..   ,//(####(, /((((/.,##*,,,. .(((((///((((*.(####(* *((((((((((*. ,(################"
echo "######%###########%##%%%%%%%%*/((%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&%%&&&&&&&&&&&&&&&&&%/ /(((((/ ,%( ,((((((((((((((((((((((.,%&&%*./((((/.,%%/.*****/((((*.,****(#%&&&&#../(((((((((* ,#&&&&&&&&&&&&&&&&&&&"
echo "%%%%%%%%%%%%%%%%%%%%%%#####//((/(##%%%&&%######(//////(###########################(.,(((((/..(#, ,////(((((((((((((((((/ ,###/.*(((((,,(#(,.(((((((((((((((((,.(##(* ,(((((((((*  ,/(#####(########((((("
echo "##########################/%@%%%%%%%##(//*,,*/,.....   ./##%######################*./(((((* ,((((((((/.,((((((/ ,//**,,,.*###.,(((((/./###, ,,,,,/(((((((((((.,#%#,./(((((((((**/((/.*##################"
echo "&&&&&&&&&&&&&&&&&&&&&&&&%(&&#&%(/*,....     .          .**/%&%######%%&&&&&&&&&&&&*.((((((/.   .#/,..,,/((((((* *%&&&&&&&&&&(.*(((((,.%%(%&%/,.. ,((((, ,.... ,%&,./((((((((((((((((/./%%(. *&&&&&&&&%&&"
echo "&&&&&&&&&&&&&&&&&&&&&&%(*,,...   .,*/###%%%%%%%%%%#(*,.   ,/#((/////(#%#(#########,.((((((((((, ,/((((((((((((((((/,.,*###%%,./((((((*,,.  *(((((((((((*,...,/#%* *(((((((((((((((((((*,,*/, #&&&&&&&&&&"
echo "&&&&&&&&&&&&&&&&&&&&#,,,  .*#############%#/%@&(/**//////(#*(/*%@@@@&*/#((%&&&&&&&*.(((((((((,.*(((((((((((((((((((((,.#&&&&/./((((((((/ .((((((((((((((((((/./&#*.,/((((((*,,/(((((((((((((.,&&&&&&&&&&"
echo "################%##. ..,(####/////(#%&&(//(%&&(......,,*(#/*&(/&@@@@@#,#/*/(#%%%%%(.,((((((((.,((((, /,.((((((((((((/ *####%#.,((((((((* *(((*.,.*((((((((((,.(#####(/..,../##,.((((((((((((/.*#########"
echo "@@@@@@@@@@@@@@@@&((####(/**(%&&@@@@@@@@%@#/#&&(,....,,,*#((@@*/&@@@@@(*#(%%%@@@@@@@%../((((((,./((((///(((((/....*(/ ,%@@@@@@%,.(((((((/ ,((((/*/(((((/,*((* (&&&&&&&&&&&&&&&&%,./((((((((/*. .#&&&&&&&&"
echo "%%%%##%#######/(###(*/(%&&&&#%&&&%#&@@@#%&(/%&#,....,,*(#/&@@,(@@@@@@,/#/(##%%&&&&%%%%(*,,,,,//.,/(((((((/*..(%%%#/,,#%%%%%%%%%(,.,***,..../((((((((*..(%#,.*&&&&&&&&&&&&&&&&&&&&%/,...,*/#%&&&&&&&&&&&&"
echo "###########(/##(//(%&&%%%%%%%###&&%&@@&#%%%/(&%/.,*/##/#*#@@&,#@@@@@%,/(((((##%##################(/**,,**/#################(((((((((((((((((/*,,,,,*/((((((((((((((((((((((((((((((((((#####(((#########"
echo "&&&&&&&&&%(#(/*/(##%%&&&&%%##&&&&#####(%%%%(*#&#/%@@&/#((@@@%,%@@@@@**#(&@&@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"
echo "&&&&&&&&#/(*,,,****/(((#%%##&((&%##%/(%%##%#/(%&/(&&/(#/@@@@(,%@@@@&,/#(&%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##%%%%%#%%###########/,(###(/############%%%%%%%%%%%%%%%%"
echo "@@@@@@@&*,.,,,,,*,***//**/(((#####%%%##(,    *(&%(#((/..,,*(*/&@@@@#,/#////(##%%%&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&/ .%@@/.#@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
echo "(((((((* ,,*###((/(#%%%%%%%%%%%%%%&&@@@@@@%, ./%&/*// .,.    (@@@@&,*((/((##%%&%####################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%/(,   /#, .(##(*/(((((((((##############"
echo "%%%%&&%/.,*/(%%%##(////////(#%%%&@@@@@@@@@@@,,(#&#/*,      ./////////%//((/%@%%########################%%%%%%%%%%%%%%%%%%%%%%%%%&&%%&&&&&&&&&&&&&&&&&&&&&&&&&&&#%,    **  ,%#. *%##%%%%%%%%%%%%#%%%%####"
echo "@@@@@@@(,*#%((((((((/////*,,,,**//((#%&&@@@@%*#%%%/,,,..%&&&&&&&&&&%#%%/((((/#(##&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&###*         ,*   (#&&%%%%%%%%%%%%%%%%%%%%%"
echo "%%%%%%#/#(#(/##(((*,.   .//,.*((((///(((#(***,*(%&&&#%&&@@@@@@@@@&(#%#//#&&&%((#%#####%%#####(/,..,,,(%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#,*/               /%%%%%%%%%%%%%%%%%%%%%%%%"
echo "%%%%#(###(#(/(*.       .,,,.///(##(*.            ,#&%%(%%%%%%%%#####(#%##%###%#/(#####(##(*...   ,,,.,.,(####################################((((((((((((((((.                   .,/(((((((((((((((#####"
echo "&&%(/(//(//,       ,%&%(/*,.*/,                   *#%%#(#%&&&&%#%%%&&&&%/(%%%%%%%((%((/,,,,,**,,,....,.,./%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###((((((#%%%%%%%%%/                       (%%%%%%&&&&&&&&&&&&"
echo "@&#(((#(.         ,(//(#/,.             .,,*/#%%%##&&##%&&&%%&(%&#%@@@&(*&&%&%#####%#,,,,,,,,,.,..,,.,.,.,%@@@@@@@@@@@@@@@@@@@@@@@@@@&&%//*,,,,,,,,,/(%&@@@@@&/                       ,%@@@@@@@@@@@@@@@@"
echo "#/(##*            *(/*.          ./#%%%###%%&&%%(***/##%@@(,/*(@#(&@@#(&(#%%&&&%///,.................,..../((//(/////((((/(((((((//*,,,,**/(###%#(((///((((//    .*.                   ,(((((((((((((((("
echo "%/#/              ..       ./#%%%%#(/*(#&&%##&@@#%&%((#&@%.   ,/*/#(,(&/%@@&@%.        ....... .. .. ...*#%&&&&&&&&&&&&&&&&&&#(//*,,*/(%%&&&&%%&%(##(##(/(%&,*,  (*,/*,                       ....,*%&&&"
echo "%/,                .  ./%%%###((((##/(#(#%&@(#@@@%%&//#&@#.,,  ,#**,,,/(%##%%.       ....  .. ... .. .(%#%%%%%%%%%%%%%%%(/**,,,...,/%&&&@@@@@@@@#(%(,*(%##%####*,%%*,,.                        ,/(//(((("
echo "&&(,.     . . .....*(###((#%%%%%%%%#(/(#%##//(####(%***(&#..,.  *%%#(*(%%%%&/,,,****,***,,,,,,,,,,,,****,,****,,,,,,,**,*****///(#%%&&@@@@@@@@@@@@@@&(*#&%##%%&&#(%%&/,                  .*((##((#&&&&&&"
echo "#########%/,  ./####((###(/*,/////((#%%(//%&@@@@@@@/**/%&, ..,. ,&@@@&&&&&&&&&&@@@@@@@&&&&&@@@@@@@@@@@&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%#&(*/,,,,,/#%&&&%(/***,                  .*#%%%%%%%%"
echo "########((*,(%%###(##(**(&%(///(((((//#%%%%####((///**/%(.  . ...%@@@@&&&&&&&&@&&&&&&&&&&&&&&&&&&&@@&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@@&%&&&%#(%*,,,,/%@@@&#//*,*.           .,*//((((((((((((("
echo "####((##((%%%%%%#(((((*//#((%//(((/(%#//###(((((%%%%//#*       ..*&&%#(((#((///***********,,,,,,,,,,*,***,,,,****,,,......,,,**/(&&@@@@@@@@@@@#(%&&%%%(**(#(//(#(%###/*,             ,*(&@@@@@@@@@@@@@@@"
echo "@@@@@@@%/////((#*(////(((///(#(/(#%%####(/(#%%%%#%%%#*.    .. . ../#*,.....   .(&%#&%%&@@@@@@@@@@@@@@@@@@&&&&&&&&&&&&%%((/*****//((%&&@@@@@@@@%%#**,/,,,,,,(%(#%&@%//(/***********/,,(%%%%%%%%%%%%%%(//("
echo "######(/*(#%&&#//((########(/#%%%#///*/##(((((((#*. .... ..  . .  .,,......*#%############################################(((/**,,*/(#%&&&&@@%#((#%%,...*/*/&&%%(*//*/(**********/,,(############(**///*"
echo "&&&&&&#,*##%&@%//((#####(/#%%%#///**((((((//**.  ... ......... .      ,#&((###%%&%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%#(//****/((#%%%%#((#(,*%&%%%%(**/*//**********,/*,,*//###%%%%%%#,**,.,**"
echo "&&&&&&&/*/*/***(#####(/(%%%#//(**(((///***.        ...... .       *%@@##&&&&%&&&&&&((#####((%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%##(/*******/((#&&#%%#///******,,********/*,,**/(/*/**#&&#***(&&&/."
echo "&&&&&&%(#/(#///((##/(#(#%#/*,*/////**,                         ,%%##%&&&(%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%&&%&&&&&%%&&&&&&%#((((#%%#,,(/*****,*,./(*.,**,****/(*/*(&&%&&&"
echo "&&&&&&&(((//(/**//#%%##((/**//***.           .... . .          .((########(##############################((((#(((((((((((((((((((((((((((#((#(((((((((((#((((#%&#(#(/**//********,,/(///,****/**(#######"
echo "######%%#//((///(#%%#(//*/*,,    *((#%%%%%%#,.....            ,/(((#####%%%#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##&&%#((((((/********,,**,,***//*,,*/*,*////(#%%%"
echo "@@@@@@@@@@&(,,*//(((*,,,.       .///#%%&@@@@@%/.        .,/(%%%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%#((/////*********,*,,****,,,,****,,,,****//*//(%"
echo "@@@@@@@@@@@@&/,***,..        ./%&%@@@@@@@@@@@@@@@@@@@@&&&%%%%&@@@@@@@@@@                                                            @@@@@@@@@@@@@@@@@&#%##(/*,,*****************,,***************,...,,*"
echo "%%##%%%%%%&@@@@#,       ./#%%%%&@@@@@@@@&&@&%%%%%%%%%%%%%%%%%%%%%%%%%%%%             Let's get started  with a new problem!!        %%%%%%%%%%%%%%%&&&&%##(//**,,,,//////(#%&&&&&&&&&&&&&%(***,***/(((/*"
echo "%%##########(((((///////**/**////*/////////(((((#####%%%%%%%%%&&&&@@@@@@                                                            @@@@@@@@@@@@@@@@@@@@&&/,....,,(&@@@@@@@@@@@@@@@@@@@@@@@@@&#/,*//((#("
echo "...........  ..   ...   ..                         .,,......,,,,,***//((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((####%%&&&&%/.  ..       *(#######((/*////*,,,,......,..,,**("
echo "...............................,,.......,,,,,,,,,,,,,,,*///((((###%%%%%%%%%&%&&&&&&&&&&%%%%%%%%%%%%%%%%%%&&&&&&&&&&&%%%%&&%&&&&&%%%%%%%%%%%%%&&&&&&&&&%#(//*//***,,,,,***////*********//*****,,.,......."

#input barking_dir
arg_dir=$1
barking_dir=`echo $PWD`
user_arr=()
dir_arr=()

########################################
#########    print function    #########
########################################
print_user_fuc() {
	for var in "${user_arr[@]}"
	do
		printf "\033[1;32m"
		printf "%s\t\t" ${var}
		printf "\033[0m"
	done
	printf "\n"
}

print_dir_fuc() {
	for var in "${dir_arr[@]}"
	do
		printf "\033[1;32m"
		printf "%s\t\t" ${var}
		printf "\033[0m"
	done
	printf "\n"
}

cd ${barking_dir}/

########################################
#########   input user_name    #########
########################################
# make user name list
for i in ${barking_dir}/*/
do
	var=`echo "$i" | rev | cut -d '/' -f2 | rev`
	user_arr+=("$var")
done

print_user_fuc

printf "Input your user name : "
read user
while :
do
	if [ ! -d ${user} ];
	then
		printf "\e[31mError : no such user name --> %s\n\e[1;0m" ${user}
		printf "do you want to make new user name of \e[31m%s\e[1;0m? [y/n] : " ${user}
		read ans
		if [ "$ans" = y ];
		then
			mkdir ${user}
			mkdir ${user}/temp
			touch ${user}/README.md
			printf "\e[32m%s\033[0m\n" "$user"
			break ;
		fi
		print_user_fuc
		printf "Input your user name : "
		read user
	else
		printf "\e[32m%s\033[0m\n" "${user}"
		break ;
	fi
done

########################################
#########    input dir_name    #########
########################################
# make project dir list
for i in ${barking_dir}/${user}/*/
do
	var=`echo "$i" | rev | cut -d '/' -f2 | rev`
	dir_arr+=("$var")
done

print_dir_fuc
dir=
printf "Input dir name : "
read dir
while :
do
	if [ ! -d ${user}/${dir} ];
	then
		printf "\e[31mError : no such directory name -- %s\n\e[1;0m" ${dir}
		printf "do you want to make directory name of \e[31m%s\e[1;0m? [y/n] : " ${dir}
		read ans
		if [ "$ans" = y ];
		then
			mkdir ${user}/${dir}
			cd ${user}/${dir}
			touch README.md
			echo "# ${dir}" > README.md
			echo "| level | problem | my_ans | hint |" >> README.md
			echo "| :--: | :--: | :--: | :--: |" >> README.md
			printf "\e[32m%s\033[0m\n" "$dir"
			break ;
		fi
		print_dir_fuc
		printf "Input dir name : "
		read dir
	else
		printf "\e[32m%s\033[0m\n" "$dir"
		break ;
	fi
done


cd ${barking_dir}/${user}/${dir}/
########################################
#######    input problem_num    ########
########################################
problem_num=
printf "Input problem num : "				#both
read problem_num

readme="README.md"
if [ ! -e README.md ];then
	echo "# ${dir}" > README.md
	echo "| level | problem | my_ans | hint |" >> README.md
	echo "| :--: | :--: | :--: | :--: |" >> README.md
fi
echo "| ? | [${problem_num}](https://www.acmicpc.net/problem/${problem_num}) | [${problem_num}.cpp](./${problem_num}/${problem_num}.cpp) |  |" >> README.md

########################################
#######    problem initalize    ########
########################################
# echo ${PWD}
number=1
mkdir ${barking_dir}/${user}/${dir}/${problem_num}
mkdir ${barking_dir}/${user}/${dir}/${problem_num}/test/

while [ $number -lt 5 ]
do
	touch ${barking_dir}/${user}/${dir}/${problem_num}/test/${number}.txt
 	((number++))
done

#cpp and Makefile
cd ${barking_dir}/${user}/${dir}/${problem_num}
cp ~/.vim/templates/skeleton_makefile ./Makefile
echo "SRC = ${problem_num}.cpp" | cat - Makefile > temp && mv temp Makefile
vim ./${problem_num}.cpp
open https://www.acmicpc.net/problem/${problem_num}
